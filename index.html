<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üê±üê∂ ÁôºÁèæÊúÄÂÉè‰Ω†ÁöÑÊÄßÊ†ºÂãïÁâ©</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+TC:wght@300;400;500;600;700&family=Kalam:wght@300;400;700&family=Caveat:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      /* Â•∂Ëå∂Ëâ≤Á≥ªÈÖçËâ≤ */
      --gradient-primary: linear-gradient(135deg, #D2B48C 0%, #BC9A6A 100%);
      --gradient-secondary: linear-gradient(135deg, #F4A7B9 0%, #E8A598 100%);
      --gradient-accent: linear-gradient(135deg, #D4C4A8 0%, #D4C4A8 100%);
      --gradient-warm: linear-gradient(135deg, #F5E6D3 0%, #E8D5B7 100%);
      --bg-color: #FDF6E3;
      --card-bg: rgba(252, 248, 227, 0.9);
      --text-primary: #8B4513;
      --text-secondary: #A0522D;
      --text-accent: #D2691E;
      --border-color: rgba(210, 180, 140, 0.3);
      --shadow-soft: 0 8px 32px rgba(139, 69, 19, 0.1);
      --shadow-hover: 0 15px 35px rgba(139, 69, 19, 0.15);
      --milktea-light: #F7F3E9;
      --milktea-medium: #E6D7C3;
      --milktea-dark: #D2B48C;
      --pink-accent: #F4A7B9;
      --khaki-accent: #C3B091;
      --border-radius: 20px;
      --animation-speed: 0.3s;
    }

    * { 
      box-sizing: border-box; 
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Inter', 'Noto Sans TC', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      background-attachment: fixed;
      color: var(--text-primary);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      line-height: 1.6;
      position: relative;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 40% 80%, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
      pointer-events: none;
      z-index: -1;
    }

    .container {
      width: 100%;
      max-width: 680px;
      background: var(--card-bg);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-soft);
      padding: 40px 30px;
      position: relative;
      overflow: hidden;
      animation: slideUp 0.8s ease-out;
    }

    .container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--gradient-primary);
    }

    .container::after {
      content: '‚ú®';
      position: absolute;
      top: 15px;
      right: 20px;
      font-size: 1.2rem;
      opacity: 0.7;
      animation: sparkle 2s ease-in-out infinite;
    }

    @keyframes sparkle {
      0%, 100% { opacity: 0.7; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.1); }
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-family: 'Caveat', 'Noto Sans TC', cursive;
      font-size: clamp(2rem, 4vw, 3rem);
      font-weight: 700;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 12px;
      letter-spacing: -0.02em;
      position: relative;
    }

    .header h1::after {
      content: 'ÔΩû';
      position: absolute;
      right: -10px;
      top: -5px;
      color: var(--pink-accent);
      font-size: 0.8em;
      opacity: 0.8;
    }

    .header .subtitle {
      font-family: 'Kalam', 'Noto Sans TC', cursive;
      font-size: 1.1rem;
      color: var(--text-secondary);
      font-weight: 400;
      opacity: 0;
      animation: fadeIn 1s ease-out 0.3s forwards;
      position: relative;
    }

    .header .subtitle::before {
      content: '‚ô°';
      margin-right: 8px;
      color: var(--pink-accent);
    }

    .header .subtitle::after {
      content: '‚ô°';
      margin-left: 8px;
      color: var(--pink-accent);
    }

    @keyframes fadeIn {
      to {
        opacity: 1;
      }
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: var(--milktea-light);
      border-radius: 4px;
      margin-bottom: 30px;
      overflow: hidden;
      box-shadow: inset 0 2px 4px rgba(139, 69, 19, 0.1);
    }

    .progress-fill {
      height: 100%;
      background: var(--gradient-primary);
      width: 0%;
      transition: width 0.5s ease-out;
      border-radius: 4px;
      position: relative;
    }

    .progress-fill::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      animation: shimmer 1.5s infinite;
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }

    .question {
      background: var(--milktea-light);
      backdrop-filter: blur(10px);
      border: 2px solid var(--border-color);
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 24px;
      box-shadow: var(--shadow-soft);
      transition: all var(--animation-speed) ease;
      opacity: 0;
      transform: translateY(20px);
      animation: questionSlideIn 0.6s ease-out forwards;
      position: relative;
      overflow: hidden;
    }

    .question::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: var(--gradient-secondary);
      opacity: 0.6;
    }

    .question:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-hover);
      border-color: var(--pink-accent);
    }

    @keyframes questionSlideIn {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .question-number {
      display: inline-block;
      width: 28px;
      height: 28px;
      background: var(--gradient-primary);
      color: white;
      border-radius: 50%;
      text-align: center;
      line-height: 28px;
      font-size: 0.9rem;
      font-weight: 600;
      margin-right: 12px;
    }

    .question p {
      font-family: 'Kalam', 'Noto Sans TC', cursive;
      font-size: 1.2rem;
      font-weight: 500;
      margin-bottom: 16px;
      color: var(--text-primary);
    }

    .options-grid {
      display: grid;
      gap: 12px;
    }

    .option {
      position: relative;
      background: var(--card-bg);
      border: 2px solid var(--milktea-medium);
      border-radius: 12px;
      padding: 16px 20px;
      cursor: pointer;
      transition: all var(--animation-speed) ease;
      backdrop-filter: blur(5px);
    }

    .option:hover {
      background: var(--milktea-light);
      border-color: var(--pink-accent);
      transform: translateX(4px);
      box-shadow: 0 4px 12px rgba(244, 167, 185, 0.3);
    }

    .option input[type="radio"] {
      position: absolute;
      opacity: 0;
      width: 0;
      height: 0;
    }

    .option input[type="radio"]:checked + .option-content {
      background: var(--gradient-secondary);
      color: white;
      border-radius: 8px;
    }

    .option input[type="radio"]:checked + .option-content::before {
      transform: scale(1);
      opacity: 1;
      color: white;
    }

    .option-content {
      position: relative;
      display: flex;
      align-items: center;
      font-family: 'Inter', 'Noto Sans TC', sans-serif;
      font-weight: 500;
      padding-left: 35px;
      transition: all var(--animation-speed) ease;
      border-radius: 8px;
      padding: 12px 16px 12px 45px;
    }

    .option-content::before {
      content: '‚ô°';
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%) scale(0);
      opacity: 0;
      transition: all var(--animation-speed) ease;
      font-weight: bold;
      color: var(--pink-accent);
    }

    .submit-button {
      width: 100%;
      padding: 16px 0;
      background: var(--gradient-primary);
      border: none;
      border-radius: 16px;
      font-family: 'Kalam', 'Noto Sans TC', cursive;
      font-size: 1.2rem;
      font-weight: 600;
      color: white;
      cursor: pointer;
      box-shadow: var(--shadow-soft);
      transition: all var(--animation-speed) ease;
      margin-top: 20px;
      position: relative;
      overflow: hidden;
    }

    .submit-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s;
    }

    .submit-button:hover {
      transform: translateY(-2px) scale(1.02);
      box-shadow: var(--shadow-hover);
    }

    .submit-button:hover::before {
      left: 100%;
    }

    .submit-button:disabled {
      background: var(--khaki-accent);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
      opacity: 0.7;
    }

    .result {
      margin-top: 30px;
      padding: 0;
      background: transparent;
      border: none;
      border-radius: 0;
      box-shadow: none;
      opacity: 0;
      animation: resultFadeIn 0.8s ease-out forwards;
    }

    /* IG Stories È¢®Ê†ºÁµêÊûúÂç°Áâá */
    .ig-result-card {
      background: linear-gradient(145deg, #ffffff 0%, #fefcf7 100%);
      border-radius: 24px;
      padding: 16px;
      box-shadow: 
        0 20px 60px rgba(0, 0, 0, 0.1),
        0 8px 30px rgba(244, 167, 185, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.8);
      position: relative;
      overflow: hidden;
      border: 2px solid rgba(244, 167, 185, 0.2);
      max-width: 350px;
      max-height: 600px;
      margin: 0 auto;
      aspect-ratio: 9/16;
      display: flex;
      flex-direction: column;
    }

    .ig-result-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: linear-gradient(90deg, #FF6B6B, #4ECDC4, #45B7D1, #96CEB4, #FFEAA7, #DDA0DD);
      background-size: 300% 300%;
      animation: gradientShift 3s ease infinite;
    }

    /* Stories È¢®Ê†ºÈ†≠ÈÉ® */
    .stories-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      padding: 10px 0;
    }

    .stories-profile {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .stories-avatar {
      width: 40px;
      height: 40px;
      background: linear-gradient(45deg, #f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      color: white;
      font-weight: bold;
    }

    .stories-info h4 {
      font-family: 'Inter', 'Noto Sans TC', sans-serif;
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--text-primary);
      margin: 0;
    }

    .stories-info p {
      font-family: 'Inter', 'Noto Sans TC', sans-serif;
      font-size: 0.75rem;
      color: #8e8e93;
      margin: 0;
    }

    .stories-time {
      font-family: 'Inter', 'Noto Sans TC', sans-serif;
      font-size: 0.75rem;
      color: #8e8e93;
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .result-header {
      text-align: center;
      margin-bottom: 12px;
      position: relative;
      flex-shrink: 0;
    }

    .result-emoji-container {
      position: relative;
      display: inline-block;
      margin-bottom: 8px;
    }

    .result-emoji {
      font-size: 2.8rem;
      position: relative;
      z-index: 2;
      animation: float 3s ease-in-out infinite;
    }

    .emoji-glow {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 80px;
      height: 80px;
      background: radial-gradient(circle, rgba(244, 167, 185, 0.3) 0%, transparent 70%);
      border-radius: 50%;
      animation: pulse-glow 2s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }

    @keyframes pulse-glow {
      0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.6; }
      50% { transform: translate(-50%, -50%) scale(1.2); opacity: 0.8; }
    }

    .result-title {
      font-family: 'Caveat', 'Noto Sans TC', cursive;
      font-size: 1.6rem;
      font-weight: 700;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 8px;
      line-height: 1.2;
    }

    .result-pet-name {
      font-family: 'Caveat', 'Noto Sans TC', cursive;
      font-size: 1.4rem;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 12px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .result-description {
      font-family: 'Kalam', 'Noto Sans TC', cursive;
      font-size: 0.9rem;
      line-height: 1.5;
      color: var(--text-secondary);
      text-align: center;
      margin-bottom: 12px;
      padding: 0 8px;
      flex-shrink: 0;
    }

    .result-mbti-badge {
      display: inline-block;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 12px 24px;
      border-radius: 50px;
      font-family: 'Inter', 'Noto Sans TC', sans-serif;
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 30px;
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
      position: relative;
      overflow: hidden;
      border: 2px solid rgba(255, 255, 255, 0.3);
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    }

    .result-mbti-badge::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      animation: shine 2s infinite;
    }

    @keyframes shine {
      0% { left: -100%; }
      100% { left: 100%; }
    }

    /* Áõ∏‰ººÂãïÁâ©Â±ïÁ§∫ÂçÄ */
    .similar-animals {
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
      border-radius: 10px;
      padding: 8px;
      margin: 6px 0;
      border: 1px solid rgba(102, 126, 234, 0.1);
      flex-shrink: 0;
    }

    .similar-title {
      font-family: 'Kalam', 'Noto Sans TC', cursive;
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--text-primary);
      text-align: center;
      margin-bottom: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 4px;
    }

    .animal-row {
      display: flex;
      justify-content: space-around;
      align-items: center;
      margin: 4px 0;
      gap: 4px;
    }

    .mini-animal {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
      flex: 1;
      text-align: center;
      min-width: 0;
    }

    .mini-animal-emoji {
      font-size: 1.2rem;
      animation: bounce-subtle 2s ease-in-out infinite;
    }

    .mini-animal-name {
      font-family: 'Inter', 'Noto Sans TC', sans-serif;
      font-size: 0.55rem;
      font-weight: 500;
      color: var(--text-secondary);
      line-height: 1.1;
      max-width: 60px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .mini-animal-type {
      font-size: 0.5rem;
      color: #8e8e93;
      font-weight: 400;
      line-height: 1;
    }

    @keyframes bounce-subtle {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-3px); }
    }

    /* ‰∫íÂãïÈÄ£ÁµêÂçÄ */
    .social-connection {
      background: linear-gradient(135deg, rgba(244, 167, 185, 0.1) 0%, rgba(210, 180, 140, 0.1) 100%);
      border-radius: 10px;
      padding: 6px;
      margin: 6px 0;
      text-align: center;
      border: 1px solid rgba(244, 167, 185, 0.2);
      flex-shrink: 0;
    }

    .connection-text {
      font-family: 'Kalam', 'Noto Sans TC', cursive;
      font-size: 0.65rem;
      color: var(--text-secondary);
      margin-bottom: 4px;
      line-height: 1.2;
    }

    .connection-tags {
      display: flex;
      justify-content: center;
      gap: 3px;
      flex-wrap: wrap;
    }

    .connection-tag {
      background: rgba(102, 126, 234, 0.1);
      color: var(--text-primary);
      padding: 2px 6px;
      border-radius: 8px;
      font-size: 0.55rem;
      font-weight: 500;
      font-family: 'Inter', 'Noto Sans TC', sans-serif;
    }

    /* Stories È¢®Ê†ºÈ†≠ÈÉ® */
    .stories-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 12px;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 16px 16px 0 0;
      margin: -16px -16px 10px -16px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      flex-shrink: 0;
    }

    .stories-profile {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .stories-avatar {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      border: 2px solid rgba(255, 255, 255, 0.3);
    }

    .stories-info {
      display: flex;
      flex-direction: column;
      gap: 1px;
    }

    .stories-username {
      font-family: 'Inter', 'Noto Sans TC', sans-serif;
      font-size: 0.75rem;
      font-weight: 600;
      color: white;
      line-height: 1;
    }

    .stories-time {
      font-family: 'Inter', 'Noto Sans TC', sans-serif;
      font-size: 0.65rem;
      color: rgba(255, 255, 255, 0.7);
      line-height: 1;
    }

    .stories-options {
      color: rgba(255, 255, 255, 0.8);
      font-size: 1rem;
      cursor: pointer;
      padding: 3px;
      border-radius: 50%;
      transition: background-color 0.2s ease;
    }

    .stories-options:hover {
      background-color: rgba(255, 255, 255, 0.1);
    }

    /* ÊªæÂãïÂçÄÂüüÊ®£Âºè */
    .scrollable-content {
      scrollbar-width: thin;
      scrollbar-color: rgba(244, 167, 185, 0.3) transparent;
    }

    .scrollable-content::-webkit-scrollbar {
      width: 3px;
    }

    .scrollable-content::-webkit-scrollbar-track {
      background: transparent;
    }

    .scrollable-content::-webkit-scrollbar-thumb {
      background: rgba(244, 167, 185, 0.3);
      border-radius: 2px;
    }

    .scrollable-content::-webkit-scrollbar-thumb:hover {
      background: rgba(244, 167, 185, 0.5);
    }

    .share-section {
      background: linear-gradient(135deg, rgba(244, 167, 185, 0.1) 0%, rgba(210, 180, 140, 0.1) 100%);
      border-radius: 12px;
      padding: 10px;
      margin-top: 8px;
      border: 1px solid rgba(244, 167, 185, 0.2);
      flex-shrink: 0;
    }

    .share-title {
      font-family: 'Kalam', 'Noto Sans TC', cursive;
      font-size: 0.8rem;
      color: var(--text-primary);
      text-align: center;
      margin-bottom: 8px;
      font-weight: 500;
    }

    .share-buttons {
      display: flex;
      justify-content: center;
      gap: 6px;
      flex-wrap: wrap;
      margin-bottom: 0;
    }

    .share-btn {
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 6px 10px;
      border: none;
      border-radius: 15px;
      font-family: 'Inter', 'Noto Sans TC', sans-serif;
      font-size: 0.65rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .share-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.15);
    }

    .share-btn.instagram {
      background: linear-gradient(45deg, #f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%);
      color: white;
    }

    .share-btn.facebook {
      background: #1877f2;
      color: white;
    }

    .share-btn.twitter {
      background: #1da1f2;
      color: white;
    }

    .share-btn.line {
      background: #00c300;
      color: white;
    }

    .share-btn.copy {
      background: linear-gradient(135deg, var(--gradient-secondary));
      color: white;
    }

    .explore-btn {
      width: 100%;
      padding: 15px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      border-radius: 15px;
      color: white;
      font-family: 'Kalam', 'Noto Sans TC', cursive;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
      position: relative;
      overflow: hidden;
    }

    .explore-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.5s;
    }

    .explore-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 35px rgba(102, 126, 234, 0.4);
    }

    .explore-btn:hover::before {
      left: 100%;
    }

    /* Ë£ùÈ£æÂÖÉÁ¥† */
    .decorative-hearts {
      position: absolute;
      top: 20px;
      right: 20px;
      font-size: 1.2rem;
      opacity: 0.6;
      animation: twinkle 2s ease-in-out infinite;
    }

    .decorative-sparkles {
      position: absolute;
      bottom: 20px;
      left: 20px;
      font-size: 1rem;
      opacity: 0.5;
      animation: twinkle 2s ease-in-out infinite 1s;
    }

    /* ÈüøÊáâÂºèË®≠Ë®à */
    @media (max-width: 768px) {
      .ig-result-card {
        padding: 30px 20px;
        margin: 0 10px;
      }
      
      .result-emoji {
        font-size: 3.5rem;
      }
      
      .result-title {
        font-size: 1.8rem;
      }
      
      .result-pet-name {
        font-size: 1.6rem;
      }
      
      .share-buttons {
        gap: 8px;
      }
      
      .share-btn {
        padding: 8px 12px;
        font-size: 0.8rem;
      }
    }

    @keyframes resultFadeIn {
      to {
        opacity: 1;
      }
    }

    .result h2 {
      font-family: 'Caveat', 'Noto Sans TC', cursive;
      font-size: 2rem;
      font-weight: 700;
      background: var(--gradient-secondary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 16px;
      text-align: center;
      position: relative;
    }

    .result h2::before {
      content: '‚úß';
      position: absolute;
      left: -40px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--pink-accent);
      font-size: 1.5rem;
      animation: twinkle 2s ease-in-out infinite;
    }

    .result h2::after {
      content: '‚úß';
      position: absolute;
      right: -40px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--pink-accent);
      font-size: 1.5rem;
      animation: twinkle 2s ease-in-out infinite 0.5s;
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0.6; transform: translateY(-50%) scale(0.8); }
      50% { opacity: 1; transform: translateY(-50%) scale(1.2); }
    }

    .result-pet {
      text-align: center;
      font-size: 3rem;
      margin: 20px 0;
    }

    .result-desc {
      font-family: 'Kalam', 'Noto Sans TC', cursive;
      font-size: 1.1rem;
      line-height: 1.8;
      color: var(--text-secondary);
      text-align: center;
    }

    /* ÈüøÊáâÂºèË®≠Ë®à */
    @media (max-width: 768px) {
      .container {
        padding: 30px 20px;
        margin: 10px;
      }
      
      .question {
        padding: 20px;
      }
      
      .option-content {
        padding: 10px 12px 10px 40px;
        font-size: 0.95rem;
      }

      .result h2::before,
      .result h2::after {
        display: none;
      }

      .header h1::after {
        right: -5px;
        font-size: 0.6em;
      }
    }

    /* Èü≥ÊïàÂíåÂõûÈ•ãÊïàÊûú */
    .option.clicked {
      animation: pulse 0.3s ease-out;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    .submit-button.clicked {
      animation: buttonPress 0.4s ease-out;
    }

    @keyframes buttonPress {
      0% { transform: translateY(-2px) scale(1.02); }
      50% { transform: translateY(2px) scale(0.98); }
      100% { transform: translateY(-2px) scale(1.02); }
    }

    .question.answered {
      border-color: var(--pink-accent);
      box-shadow: 0 0 20px rgba(244, 167, 185, 0.4);
    }

    .floating-hearts {
      position: absolute;
      pointer-events: none;
      color: var(--pink-accent);
      font-size: 1.5rem;
      animation: floatUp 2s ease-out forwards;
    }

    @keyframes floatUp {
      0% { 
        opacity: 1; 
        transform: translateY(0) scale(1); 
      }
      100% { 
        opacity: 0; 
        transform: translateY(-50px) scale(0.5); 
      }
    }

    .progress-celebration {
      position: relative;
      overflow: visible;
    }

    .progress-celebration::after {
      content: 'üéâ';
      position: absolute;
      top: -30px;
      right: 0;
      font-size: 1.5rem;
      opacity: 0;
      animation: celebrate 0.8s ease-out;
    }

    @keyframes celebrate {
      0% { opacity: 0; transform: translateY(10px) scale(0.5); }
      50% { opacity: 1; transform: translateY(-10px) scale(1.2); }
      100% { opacity: 0; transform: translateY(-20px) scale(0.8); }
    }

    .result-entrance {
      animation: resultEntrance 1s ease-out;
    }

    @keyframes resultEntrance {
      0% { 
        opacity: 0; 
        transform: translateY(50px) scale(0.8); 
      }
      50% { 
        opacity: 0.8; 
        transform: translateY(-10px) scale(1.05); 
      }
      100% { 
        opacity: 1; 
        transform: translateY(0) scale(1); 
      }
    }

    @keyframes bounce {
      0%, 20%, 53%, 80%, 100% {
        transform: translate(0, 0);
      }
      40%, 43% {
        transform: translate(0, -15px);
      }
      70% {
        transform: translate(0, -7px);
      }
      90% {
        transform: translate(0, -3px);
      }
    }

    /* Êé¢Á¥¢Êõ¥Â§öÂçÄÂüüÊ®£Âºè */
    .explore-more {
      margin-top: 40px;
      padding: 30px;
      background: var(--card-bg);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-soft);
      opacity: 0;
      animation: resultFadeIn 0.8s ease-out forwards;
    }

    .explore-header {
      text-align: center;
      margin-bottom: 30px;
    }

    .explore-header h2 {
      font-family: 'Caveat', 'Noto Sans TC', cursive;
      font-size: 2rem;
      font-weight: 700;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 10px;
    }

    .explore-header p {
      font-family: 'Kalam', 'Noto Sans TC', cursive;
      color: var(--text-secondary);
      font-size: 1.1rem;
    }

    .filter-section {
      margin-bottom: 30px;
    }

    .filter-group {
      margin-bottom: 20px;
    }

    .filter-label {
      display: block;
      font-family: 'Kalam', 'Noto Sans TC', cursive;
      font-size: 1.1rem;
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 10px;
    }

    .filter-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .filter-btn {
      padding: 8px 16px;
      border: 2px solid var(--milktea-medium);
      background: var(--card-bg);
      border-radius: 20px;
      font-family: 'Inter', 'Noto Sans TC', sans-serif;
      font-size: 0.9rem;
      font-weight: 500;
      color: var(--text-primary);
      cursor: pointer;
      transition: all var(--animation-speed) ease;
      backdrop-filter: blur(5px);
    }

    .filter-btn:hover {
      background: var(--milktea-light);
      border-color: var(--pink-accent);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(244, 167, 185, 0.3);
    }

    .filter-btn.active {
      background: var(--gradient-secondary);
      border-color: var(--pink-accent);
      color: white;
      box-shadow: 0 4px 12px rgba(244, 167, 185, 0.4);
    }

    .animal-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
    }

    .animal-card {
      background: var(--milktea-light);
      border: 2px solid var(--border-color);
      border-radius: 16px;
      padding: 20px;
      transition: all var(--animation-speed) ease;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    .animal-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: var(--gradient-secondary);
      opacity: 0.6;
    }

    .animal-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-hover);
      border-color: var(--pink-accent);
    }

    .card-header {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
    }

    .card-emoji {
      font-size: 2rem;
      margin-right: 12px;
    }

    .card-title {
      flex: 1;
    }

    .card-species {
      font-family: 'Caveat', 'Noto Sans TC', cursive;
      font-size: 1.3rem;
      font-weight: 600;
      color: var(--text-primary);
      margin: 0;
    }

    .card-mbti {
      font-family: 'Inter', 'Noto Sans TC', sans-serif;
      font-size: 0.9rem;
      color: var(--text-accent);
      font-weight: 500;
    }

    .card-element {
      background: var(--gradient-accent);
      color: var(--text-primary);
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 0.8rem;
      font-weight: 500;
      white-space: nowrap;
    }

    .card-description {
      font-family: 'Kalam', 'Noto Sans TC', cursive;
      font-size: 1rem;
      line-height: 1.6;
      color: var(--text-secondary);
      margin-top: 12px;
    }

    .card-match {
      position: absolute;
      top: 15px;
      right: 15px;
      background: var(--gradient-secondary);
      color: white;
      padding: 4px 8px;
      border-radius: 8px;
      font-size: 0.7rem;
      font-weight: 600;
      opacity: 0;
      transform: scale(0);
      transition: all var(--animation-speed) ease;
    }

    .animal-card.perfect-match .card-match {
      opacity: 1;
      transform: scale(1);
    }

    @media (max-width: 768px) {
      .filter-buttons {
        flex-direction: column;
      }
      
      .filter-btn {
        text-align: center;
      }
      
      .animal-grid {
        grid-template-columns: 1fr;
      }
      
      .card-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
      }
      
      .card-element {
        align-self: flex-start;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üê±üê∂ ÁôºÁèæÊúÄÂÉè‰Ω†ÁöÑÊÄßÊ†ºÂãïÁâ©</h1>
      <p class="subtitle">ÈÄèÈÅé MBTI ÊÄßÊ†ºÊ∏¨È©óÔºåÊâæÂà∞Âíå‰Ω†ÊúÄÁõ∏‰ººÁöÑË≤ìË≤ìÊàñÁãóÁãó</p>
    </div>
    
    <div class="progress-bar">
      <div class="progress-fill" id="progressFill"></div>
    </div>

    <form id="quizForm">
      <div class="question" style="animation-delay: 0.1s">
        <p><span class="question-number">1</span>‰Ω†ÈÄöÂ∏∏Âú®ËÅöÊúÉ‰∏≠ÊúÉÊÄéÈ∫ºÂÅöÔºü</p>
        <div class="options-grid">
          <label class="option">
            <input type="radio" name="q1" value="E">
            <div class="option-content">üéâ ÂñúÊ≠°ÂíåÊúãÂèã‰∫íÂãïÔºå‰∫´ÂèóÁÜ±È¨ßÊ∞õÂúç</div>
          </label>
          <label class="option">
            <input type="radio" name="q1" value="I">
            <div class="option-content">ü§î ÂñúÊ≠°Áç®Ëá™ÊÄùËÄÉÔºåËßÄÂØüÂë®ÂúçÁí∞Â¢É</div>
          </label>
        </div>
      </div>

      <div class="question" style="animation-delay: 0.2s">
        <p><span class="question-number">2</span>‰Ω†Âú®ÂÅöÊ±∫Á≠ñÊôÇËºÉÂÇæÂêëÔºö</p>
        <div class="options-grid">
          <label class="option">
            <input type="radio" name="q2" value="S">
            <div class="option-content">üìä Ê≥®ÈáçÂØ¶ÈöõÁ¥∞ÁØÄÂíåÂÖ∑È´î‰∫ãÂØ¶</div>
          </label>
          <label class="option">
            <input type="radio" name="q2" value="N">
            <div class="option-content">üí≠ ÊÜëÁõ¥Ë¶∫ÂíåÊÉ≥ÂÉèÂäõÊÄùËÄÉ</div>
          </label>
        </div>
      </div>

      <div class="question" style="animation-delay: 0.3s">
        <p><span class="question-number">3</span>‰Ω†ÂÅöÊ±∫ÂÆöÊôÇËºÉÁúãÈáçÔºö</p>
        <div class="options-grid">
          <label class="option">
            <input type="radio" name="q3" value="T">
            <div class="option-content">üß† ÈÇèËºØÂàÜÊûêËàáÂÆ¢ËßÄÂà§Êñ∑</div>
          </label>
          <label class="option">
            <input type="radio" name="q3" value="F">
            <div class="option-content">‚ù§Ô∏è ÊÉÖÊÑüËÄÉÈáèËàáÂÉπÂÄºËßÄÂøµ</div>
          </label>
        </div>
      </div>

      <div class="question" style="animation-delay: 0.4s">
        <p><span class="question-number">4</span>‰Ω†ÂÅèÂ•ΩÁöÑÁîüÊ¥ªÊñπÂºèÔºö</p>
        <div class="options-grid">
          <label class="option">
            <input type="radio" name="q4" value="J">
            <div class="option-content">üìÖ Ë®àÁï´ÊúâÂ∫èÔºåÂñúÊ≠°Á¢∫ÂÆöÊÄß</div>
          </label>
          <label class="option">
            <input type="radio" name="q4" value="P">
            <div class="option-content">üé≠ Èö®ÊÄßÂΩàÊÄßÔºå‰øùÊåÅÈñãÊîæÊÖãÂ∫¶</div>
          </label>
        </div>
      </div>

      <div class="question" style="animation-delay: 0.5s">
        <p><span class="question-number">5</span>‰ª•‰∏ãÂì™ÂÄãÂÖÉÁ¥†ÊúÄÁ¨¶Âêà‰Ω†ÁöÑÊÄßÊ†ºÔºü</p>
        <div class="options-grid">
          <label class="option">
            <input type="radio" name="q5" value="fire">
            <div class="option-content">üî• ÁÅ´Ë±° - ÁÜ±ÊÉÖÊ¥ªÂäõÔºåÂÖÖÊªøËÉΩÈáè</div>
          </label>
          <label class="option">
            <input type="radio" name="q5" value="earth">
            <div class="option-content">üåç ÂúüË±° - Á©©ÈáçË∏èÂØ¶ÔºåÊ≥®ÈáçÂÆâÂÖ®</div>
          </label>
          <label class="option">
            <input type="radio" name="q5" value="air">
            <div class="option-content">üí® È¢®Ë±° - ÈùàÊ¥ªËÆäÈÄöÔºåÊÄùÁ∂≠ÊïèÊç∑</div>
          </label>
          <label class="option">
            <input type="radio" name="q5" value="water">
            <div class="option-content">üíß Ê∞¥Ë±° - ÊÑüÊÄßÁ¥∞ËÜ©ÔºåÊÉÖÊÑüË±êÂØå</div>
          </label>
        </div>
      </div>

      <button type="button" class="submit-button" id="submitBtn" disabled>
        <span id="btnText">Ë´ãÂÆåÊàêÊâÄÊúâÈ°åÁõÆ</span>
      </button>
    </form>

    <div id="result" class="result" style="display: none;"></div>
    
    <!-- Êé¢Á¥¢Êõ¥Â§öÁõ∏‰ººÂãïÁâ©ÂçÄÂüü -->
    <div id="exploreMore" class="explore-more" style="display: none;">
      <div class="explore-header">
        <h2>üîç Êé¢Á¥¢Êõ¥Â§öÁõ∏‰ººÁöÑÊØõÂ≠©</h2>
        <p>Ê†πÊìö‰Ω†ÁöÑ MBTI È°ûÂûãÔºåÁôºÁèæÊõ¥Â§öÂÄãÊÄßÁõ∏ËøëÁöÑË≤ìÂí™ÂíåÁãóÁãó</p>
      </div>
      
      <div class="filter-section">
        <div class="filter-group">
          <label class="filter-label">üß† ÈÅ∏Êìá MBTI Ë±°ÈôêÔºö</label>
          <div class="filter-buttons">
            <button class="filter-btn" data-filter="all" data-type="mbti">ÂÖ®ÈÉ®</button>
            <button class="filter-btn" data-filter="analysts" data-type="mbti">ÁêÜÂøµÂûã (NT)</button>
            <button class="filter-btn" data-filter="diplomats" data-type="mbti">Â§ñ‰∫§Âûã (NF)</button>
            <button class="filter-btn" data-filter="sentinels" data-type="mbti">ÂÆàË≠∑Âûã (SJ)</button>
            <button class="filter-btn" data-filter="explorers" data-type="mbti">Êé¢Èö™Âûã (SP)</button>
          </div>
        </div>
        
        <div class="filter-group">
          <label class="filter-label">‚≠ê ÈÅ∏ÊìáÊòüÂ∫ßÂÖÉÁ¥†Ôºö</label>
          <div class="filter-buttons">
            <button class="filter-btn" data-filter="all" data-type="element">ÂÖ®ÈÉ®</button>
            <button class="filter-btn" data-filter="ÁÅ´Ë±°" data-type="element">üî• ÁÅ´Ë±°</button>
            <button class="filter-btn" data-filter="ÂúüË±°" data-type="element">üåç ÂúüË±°</button>
            <button class="filter-btn" data-filter="È¢®Ë±°" data-type="element">üí® È¢®Ë±°</button>
            <button class="filter-btn" data-filter="Ê∞¥Ë±°" data-type="element">üíß Ê∞¥Ë±°</button>
          </div>
        </div>
        
        <div class="filter-group">
          <label class="filter-label">üêæ ÈÅ∏ÊìáÂãïÁâ©È°ûÂûãÔºö</label>
          <div class="filter-buttons">
            <button class="filter-btn" data-filter="all" data-type="species">ÂÖ®ÈÉ®</button>
            <button class="filter-btn" data-filter="cats" data-type="species">üê± Ë≤ìÂí™</button>
            <button class="filter-btn" data-filter="dogs" data-type="species">üê∂ ÁãóÁãó</button>
          </div>
        </div>
      </div>
      
      <div id="animalGrid" class="animal-grid"></div>
    </div>
  </div>

  <script>
    // Èü≥ÊïàÁ≥ªÁµ±
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    
    // ÂãïÁâ©Êï∏ÊìöÂ≠òÂÑ≤
    let animalData = [];
    let currentUserResult = null;
    
    // ËºâÂÖ•ÂãïÁâ©Êï∏Êìö
    async function loadAnimalData() {
      try {
        const response = await fetch('./details.json');
        const data = await response.json();
        
        // Â∞áÂÖßÂêëÂíåÂ§ñÂêëÁöÑÊï∏ÊìöÂêà‰Ωµ
        animalData = [...data.I, ...data.E];
        console.log('ÂãïÁâ©Êï∏ÊìöËºâÂÖ•ÊàêÂäü:', animalData.length, 'Á≠ÜË≥áÊñô');
      } catch (error) {
        console.error('ËºâÂÖ•ÂãïÁâ©Êï∏ÊìöÂ§±Êïó:', error);
        // Â¶ÇÊûúËºâÂÖ•Â§±ÊïóÔºå‰ΩøÁî®ÂÇôÁî®Êï∏Êìö
        animalData = generateFallbackData();
      }
    }
    
    // ÂÇôÁî®Êï∏ÊìöÔºàÁï∂ÁÑ°Ê≥ïËºâÂÖ• JSON ÊôÇ‰ΩøÁî®Ôºâ
    function generateFallbackData() {
      return [
        { mbti: 'ISTJ', zodiac_element: 'ÁÅ´Ë±°', species: 'Ëã±ÂúãÁü≠ÊØõË≤ì (British Shorthair)', description: 'Á©©ÈáçÂçªÂÅ∂ÁàæÁÜ±ÊÉÖÔºåÁµ¶‰Ω†ÂÆâÂÖ®ÊÑüÁöÑÂÆàË≠∑ËÄÖ' },
        { mbti: 'ISFJ', zodiac_element: 'ÁÅ´Ë±°', species: 'Â∏ÉÂÅ∂Ë≤ì (Ragdoll)', description: 'ÁÜ±ÊÉÖÂèàË¶™‰∫∫ÔºåÊòØÊúÄÊ∫´ÊöñÁöÑÊ≤ªÁôíÁ≥ªÂ§•‰º¥' },
        { mbti: 'ESTJ', zodiac_element: 'ÁÅ´Ë±°', species: 'Âæ∑ÂúãÁâßÁæäÁä¨ (German Shepherd)', description: 'ËÅ∞Êòé‰∏îÊúçÂæûÔºåÂ§©ÁîüÁöÑÈ†òÂ∞éËÄÖÔºå‰øùË≠∑ÊÖæÂº∑' },
        { mbti: 'ESFJ', zodiac_element: 'ÁÅ´Ë±°', species: 'ÈªÉÈáëÁçµÁä¨ (Golden Retriever)', description: 'ÁÜ±ÊÉÖÂèãÂñÑÔºåÂ∏∂Áµ¶‰Ω†ÊªøÊªøÈôΩÂÖâËàáÊ≠£ËÉΩÈáè' },
        { mbti: 'INTJ', zodiac_element: 'ÂúüË±°', species: 'Áï∞ÂúãÁü≠ÊØõË≤ì (Exotic Shorthair)', description: 'Á©©ÈáçËÅ∞ÊÖßÔºåÂÜ∑ÈùúË®àÁï´Âûã‰∫∫Ê†º' },
        { mbti: 'INFJ', zodiac_element: 'ÂúüË±°', species: '‰øÑÁæÖÊñØËóçË≤ì (Russian Blue)', description: 'ÂÑ™ÈõÖÁ•ûÁßòÔºåÊòØÂÖßÊñÇÁöÑÁêÜÊÉ≥‰∏ªÁæ©ËÄÖ' }
      ];
    }
    
    // MBTI Ë±°ÈôêÂàÜÈ°û
    const mbtiGroups = {
      analysts: ['INTJ', 'INTP', 'ENTJ', 'ENTP'], // ÁêÜÂøµÂûã (NT)
      diplomats: ['INFJ', 'INFP', 'ENFJ', 'ENFP'], // Â§ñ‰∫§Âûã (NF)
      sentinels: ['ISTJ', 'ISFJ', 'ESTJ', 'ESFJ'], // ÂÆàË≠∑Âûã (SJ)
      explorers: ['ISTP', 'ISFP', 'ESTP', 'ESFP']  // Êé¢Èö™Âûã (SP)
    };
    
    // ÂèñÂæóÂãïÁâ©Ë°®ÊÉÖÁ¨¶Ëôü
    function getAnimalEmoji(species) {
      const cats = ['Ë≤ì', 'Cat', 'cat'];
      const dogs = ['Áä¨', 'Áãó', 'Dog', 'dog'];
      
      if (cats.some(keyword => species.includes(keyword))) return 'üê±';
      if (dogs.some(keyword => species.includes(keyword))) return 'üê∂';
      return 'üêæ';
    }
    
    // ÂèñÂæóÁõ∏‰ººÂ∫¶Ë©ïÂàÜ
    function getSimilarityScore(animal, userMbti, userElement) {
      let score = 0;
      
      // MBTI ÂÆåÂÖ®ÂåπÈÖç
      if (animal.mbti === userMbti) score += 100;
      
      // MBTI Ë±°ÈôêÂåπÈÖç
      const userGroup = Object.keys(mbtiGroups).find(group => 
        mbtiGroups[group].includes(userMbti)
      );
      const animalGroup = Object.keys(mbtiGroups).find(group => 
        mbtiGroups[group].includes(animal.mbti)
      );
      if (userGroup === animalGroup && animal.mbti !== userMbti) score += 60;
      
      // ÊòüÂ∫ßÂÖÉÁ¥†ÂåπÈÖç
      if (animal.zodiac_element === userElement) score += 40;
      
      // ÂÖ∂‰ªñÈÉ®ÂàÜÂåπÈÖç
      if (userMbti[0] === animal.mbti[0]) score += 20; // I/E ÂåπÈÖç
      if (userMbti[1] === animal.mbti[1]) score += 20; // S/N ÂåπÈÖç
      if (userMbti[2] === animal.mbti[2]) score += 20; // T/F ÂåπÈÖç
      if (userMbti[3] === animal.mbti[3]) score += 20; // J/P ÂåπÈÖç
      
      return score;
    }
    
    // ÁØ©ÈÅ∏ÂãïÁâ©Êï∏Êìö
    function filterAnimals(mbtiFilter, elementFilter, speciesFilter) {
      let filtered = animalData;
      
      // MBTI Ë±°ÈôêÁØ©ÈÅ∏
      if (mbtiFilter !== 'all') {
        if (mbtiGroups[mbtiFilter]) {
          filtered = filtered.filter(animal => 
            mbtiGroups[mbtiFilter].includes(animal.mbti)
          );
        }
      }
      
      // ÊòüÂ∫ßÂÖÉÁ¥†ÁØ©ÈÅ∏
      if (elementFilter !== 'all') {
        filtered = filtered.filter(animal => 
          animal.zodiac_element.includes(elementFilter)
        );
      }
      
      // ÂãïÁâ©È°ûÂûãÁØ©ÈÅ∏
      if (speciesFilter !== 'all') {
        if (speciesFilter === 'cats') {
          filtered = filtered.filter(animal => 
            ['Ë≤ì', 'Cat', 'cat'].some(keyword => animal.species.includes(keyword))
          );
        } else if (speciesFilter === 'dogs') {
          filtered = filtered.filter(animal => 
            ['Áä¨', 'Áãó', 'Dog', 'dog'].some(keyword => animal.species.includes(keyword))
          );
        }
      }
      
      return filtered;
    }
    
    // È°ØÁ§∫ÂãïÁâ©Âç°Áâá
    function displayAnimals(animals, userMbti = null, userElement = null) {
      const grid = document.getElementById('animalGrid');
      
      // Â¶ÇÊûúÊúâ‰ΩøÁî®ËÄÖÁµêÊûúÔºåÊåâÁõ∏‰ººÂ∫¶ÊéíÂ∫è
      if (userMbti && userElement) {
        animals = animals.map(animal => ({
          ...animal,
          similarity: getSimilarityScore(animal, userMbti, userElement)
        })).sort((a, b) => b.similarity - a.similarity);
      }
      
      grid.innerHTML = animals.map(animal => {
        const emoji = getAnimalEmoji(animal.species);
        const isPerfectMatch = userMbti && userElement && 
          animal.mbti === userMbti && animal.zodiac_element.includes(userElement);
        
        return `
          <div class="animal-card ${isPerfectMatch ? 'perfect-match' : ''}" onclick="playClickSound()">
            ${isPerfectMatch ? '<div class="card-match">ÂÆåÁæéÂåπÈÖç!</div>' : ''}
            <div class="card-header">
              <div class="card-emoji">${emoji}</div>
              <div class="card-title">
                <h3 class="card-species">${animal.species}</h3>
                <div class="card-mbti">${animal.mbti}</div>
              </div>
              <div class="card-element">${animal.zodiac_element}</div>
            </div>
            <p class="card-description">${animal.description}</p>
          </div>
        `;
      }).join('');
      
      // Ê∑ªÂä†Âç°ÁâáÂá∫ÁèæÂãïÁï´
      const cards = grid.querySelectorAll('.animal-card');
      cards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        setTimeout(() => {
          card.style.transition = 'all 0.5s ease';
          card.style.opacity = '1';
          card.style.transform = 'translateY(0)';
        }, index * 100);
      });
    }
    
    // Ë®≠ÁΩÆÁØ©ÈÅ∏Âô®‰∫ã‰ª∂Áõ£ËÅΩ
    function setupFilters() {
      const filterBtns = document.querySelectorAll('.filter-btn');
      let currentFilters = {
        mbti: 'all',
        element: 'all',
        species: 'all'
      };
      
      filterBtns.forEach(btn => {
        btn.addEventListener('click', function() {
          const filterType = this.dataset.type;
          const filterValue = this.dataset.filter;
          
          // Êõ¥Êñ∞ÂêåÈ°ûÂûãÊåâÈàïÁöÑÁãÄÊÖã
          document.querySelectorAll(`[data-type="${filterType}"]`).forEach(b => 
            b.classList.remove('active')
          );
          this.classList.add('active');
          
          // Êõ¥Êñ∞ÁØ©ÈÅ∏Ê¢ù‰ª∂
          currentFilters[filterType] = filterValue;
          
          // Êí≠ÊîæÈªûÊìäÈü≥Êïà
          playClickSound();
          
          // ÊáâÁî®ÁØ©ÈÅ∏
          const filtered = filterAnimals(
            currentFilters.mbti, 
            currentFilters.element, 
            currentFilters.species
          );
          
          displayAnimals(
            filtered, 
            currentUserResult?.mbti, 
            currentUserResult?.element
          );
        });
      });
      
      // Ë®≠ÁΩÆÈªòË™çÈÅ∏‰∏≠ÁãÄÊÖã
      document.querySelectorAll('[data-filter="all"]').forEach(btn => {
        btn.classList.add('active');
      });
    }
    
    function playSound(frequency, duration, type = 'sine') {
      try {
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
        oscillator.type = type;
        
        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
        
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + duration);
      } catch (e) {
        console.log('Audio not supported');
      }
    }

    function playClickSound() {
      playSound(800, 0.1, 'sine');
    }

    function playSuccessSound() {
      playSound(523, 0.2, 'sine'); // C5
      setTimeout(() => playSound(659, 0.2, 'sine'), 100); // E5
      setTimeout(() => playSound(784, 0.3, 'sine'), 200); // G5
    }

    function playCompletionSound() {
      const notes = [261, 329, 392, 523]; // C-E-G-C chord
      notes.forEach((note, index) => {
        setTimeout(() => playSound(note, 0.5, 'sine'), index * 100);
      });
    }

    // UI ÂõûÈ•ãÊïàÊûú
    function createFloatingHearts(element) {
      for (let i = 0; i < 3; i++) {
        const heart = document.createElement('div');
        heart.className = 'floating-hearts';
        heart.textContent = '‚ô°';
        heart.style.left = Math.random() * 50 + 'px';
        heart.style.animationDelay = i * 0.2 + 's';
        element.style.position = 'relative';
        element.appendChild(heart);
        
        setTimeout(() => heart.remove(), 2000);
      }
    }

    function addProgressCelebration() {
      const progressBar = document.querySelector('.progress-bar');
      progressBar.classList.add('progress-celebration');
      setTimeout(() => {
        progressBar.classList.remove('progress-celebration');
      }, 800);
    }

    // ÈÄ≤Â∫¶Ê¢ùÊõ¥Êñ∞ÂíåË°®ÂñÆÈ©óË≠â
    const form = document.getElementById('quizForm');
    const progressFill = document.getElementById('progressFill');
    const submitBtn = document.getElementById('submitBtn');
    const btnText = document.getElementById('btnText');
    const totalQuestions = 5;

    function updateProgress() {
      const answeredQuestions = form.querySelectorAll('input[type="radio"]:checked').length;
      const progress = (answeredQuestions / totalQuestions) * 100;
      
      // Âπ≥ÊªëÂãïÁï´Êõ¥Êñ∞ÈÄ≤Â∫¶Ê¢ù
      progressFill.style.width = progress + '%';
      
      // Â¶ÇÊûúÊúâÈÄ≤Ê≠•ÔºåÊí≠ÊîæÈü≥ÊïàÂíåÂãïÁï´
      if (progress > 0) {
        playClickSound();
        if (progress === 100) {
          addProgressCelebration();
          playCompletionSound();
        }
      }
      
      if (answeredQuestions === totalQuestions) {
        submitBtn.disabled = false;
        submitBtn.style.background = 'var(--gradient-primary)';
        btnText.textContent = '‚ú® Êü•ÁúãÊúÄÂÉèÊàëÁöÑÊÄßÊ†ºÂãïÁâ©';
        
        // ÊåâÈàïÊ∫ñÂÇôÂ•ΩÁöÑË¶ñË¶∫ÊïàÊûú
        submitBtn.style.animation = 'pulse 1s ease-in-out infinite';
      } else {
        submitBtn.disabled = true;
        submitBtn.style.background = 'var(--khaki-accent)';
        submitBtn.style.animation = 'none';
        btnText.textContent = `ÈÇÑÈúÄÂõûÁ≠î ${totalQuestions - answeredQuestions} ÂÄãÂïèÈ°å ‚ô°`;
      }
    }

    // ÁÇ∫ÊâÄÊúâ radio ÊåâÈàïÊ∑ªÂä†Â¢ûÂº∑ÁöÑ‰∫ã‰ª∂Áõ£ËÅΩÂô®
    form.querySelectorAll('input[type="radio"]').forEach(radio => {
      radio.addEventListener('change', function() {
        updateProgress();
        
        // Ê∑ªÂä†Ë¶ñË¶∫ÂõûÈ•ã
        const option = this.closest('.option');
        const question = this.closest('.question');
        
        option.classList.add('clicked');
        question.classList.add('answered');
        
        // ÂâµÂª∫ÊµÆÂãïÊÑõÂøÉÊïàÊûú
        createFloatingHearts(option);
        
        setTimeout(() => {
          option.classList.remove('clicked');
        }, 300);
      });

      // Ê∑ªÂä†Êá∏ÂÅúÈü≥Êïà
      radio.closest('.option').addEventListener('mouseenter', function() {
        if (!this.querySelector('input').checked) {
          playSound(400, 0.05, 'sine');
        }
      });
    });

    // Â¢ûÂº∑ÁöÑÊèê‰∫§ÊåâÈàï‰∫ã‰ª∂
    document.getElementById('submitBtn').addEventListener('click', function() {
      console.log('Êèê‰∫§ÊåâÈàïË¢´ÈªûÊìä, disabled:', this.disabled);
      
      if (!this.disabled) {
        console.log('ÊåâÈàïÊú™Ë¢´Á¶ÅÁî®ÔºåÈñãÂßãËôïÁêÜ...');
        
        // Á´ãÂç≥È°ØÁ§∫ÁµêÊûúÔºå‰∏ç‰æùË≥¥Ë§áÈõúÁöÑÂãïÁï´ÊàñÈü≥Êïà
        try {
          showResult();
          console.log('showResult Ë™øÁî®ÊàêÂäü');
        } catch (error) {
          console.error('showResult Ë™øÁî®Â§±Êïó:', error);
        }
        
        // Ê∑ªÂä†Ë¶ñË¶∫ÂèçÈ•ã
        this.classList.add('clicked');
        setTimeout(() => {
          this.classList.remove('clicked');
        }, 400);
        
        // ÂòóË©¶Êí≠ÊîæÈü≥Êïà
        try {
          playSuccessSound();
        } catch (e) {
          console.log('Èü≥ÊïàÊí≠ÊîæÂ§±Êïó:', e);
        }
      } else {
        console.log('ÊåâÈàïË¢´Á¶ÅÁî®ÔºåÁÑ°Ê≥ïÊèê‰∫§');
      }
    });

    // Ê∏¨È©óÁµêÊûúÂ∞çÊáâË°®
    const quizMapping = {
      ISTJ: {
        fire: {pet: 'Ëã±ÂúãÁü≠ÊØõË≤ì British Shorthair', desc: 'Á©©ÈáçÂçªÂÅ∂ÁàæÁÜ±ÊÉÖÔºåÁµ¶‰Ω†ÂÆâÂÖ®ÊÑüÁöÑÂÆàË≠∑ËÄÖ', emoji: 'üê±'},
        earth: {pet: 'ËòáÊ†ºËò≠Êë∫ËÄ≥Ë≤ì Scottish Fold', desc: 'ÂÆâÈùú‰πñÂ∑ßÔºåÊòØÁ©©ÂÆöÁîüÊ¥ªÁöÑÊúÄ‰Ω≥Â§•‰º¥', emoji: 'üê±'},
        air: {pet: 'ÁæéÂúãÁü≠ÊØõË≤ì American Shorthair', desc: 'ÁêÜÊÄß‰∏≠Â∏∂ÈªûÈùàÊ¥ªÔºåËÉΩËºïÈ¨ÜÊáâÂ∞çËÆäÂåñ', emoji: 'üê±'},
        water: {pet: 'ÂñúÈ¶¨ÊãâÈõÖË≤ì Himalayan', desc: 'ÂÖßÊñÇÊ∫´ÂíåÔºåÈªòÈªòÂÆàË≠∑‰Ω†', emoji: 'üê±'}
      },
      ISFJ: {
        fire: {pet: 'Â∏ÉÂÅ∂Ë≤ì Ragdoll', desc: 'ÁÜ±ÊÉÖÂèàË¶™‰∫∫ÔºåÊòØÊúÄÊ∫´ÊöñÁöÑÊ≤ªÁôíÁ≥ªÂ§•‰º¥', emoji: 'üê±'},
        earth: {pet: 'Ê≥¢ÊñØË≤ì Persian', desc: 'È´òÈõÖÂÆâÈùúÔºåÂ∞ç‰Ω†Âø†Ë™†‰∏çÊ∏ù', emoji: 'üê±'},
        air: {pet: 'ÊöπÁæÖË≤ì Siamese', desc: 'Ê©üÊô∫Ë≤ºÂøÉÔºåÁ∏ΩÂú®Ë∫´ÈÇäÈªòÈªòÂÆàË≠∑', emoji: 'üê±'},
        water: {pet: 'Á∑¨Âõ†Ë≤ì Maine Coon', desc: 'Â∑®Â§ßÂçªÊ∫´ÊüîÔºåÁµ¶‰Ω†ÊªøÊªøÂÆâÂÖ®ÊÑü', emoji: 'üê±'}
      },
      INFJ: {
        fire: {pet: 'ÈòøÊØîË•øÂ∞º‰∫ûË≤ì Abyssinian', desc: 'ÁÜ±ÊÉÖ‰∏îÊúâÈ†òÂ∞éÊ∞£Ë≥™ÔºåÂÖßÂøÉÂçªÊµ™Êº´Ê∑±ÊÉÖ', emoji: 'üê±'},
        earth: {pet: '‰øÑÁæÖÊñØËóçË≤ì Russian Blue', desc: 'ÂÑ™ÈõÖÁ•ûÁßòÔºåÊòØÂÖßÊñÇÁöÑÁêÜÊÉ≥‰∏ªÁæ©ËÄÖ', emoji: 'üê±'},
        air: {pet: 'ÊöπÁæÖË≤ì Siamese', desc: 'ÂâµÊÑèÁÑ°ÈôêÔºåÁ∏ΩÊúâÂá∫ÂÖ∂‰∏çÊÑèÁöÑÈªûÂ≠ê', emoji: 'üê±'},
        water: {pet: 'Á∑¨Áî∏Ë≤ì Burmese', desc: 'ÊÑüÊÉÖË±êÂØåÔºåÊ∫´ÊüîÁ¥∞ËÜ©ÔºåÂñúÊ≠°Ê∑±Â∫¶ÈÄ£Áµê', emoji: 'üê±'}
      },
      INTJ: {
        fire: {pet: 'Â≠üÂä†ÊãâË≤ì Bengal', desc: 'ÈáéÊÄßÂçÅË∂≥ÔºåÂçªÊöóËóèÁ≠ñÁï•ÔºåÊòØÂÜíÈö™ÂÆ∂ÂûãÊÄùËÄÉËÄÖ', emoji: 'üê±'},
        earth: {pet: 'Áï∞ÂúãÁü≠ÊØõË≤ì Exotic Shorthair', desc: 'Á©©ÈáçËÅ∞ÊÖßÔºåÂÜ∑ÈùúË®àÁï´Âûã‰∫∫Ê†º', emoji: 'üê±'},
        air: {pet: 'ÊöπÁæÖË≤ì Siamese', desc: 'Â∞èÂ∑ßÈùàÊ¥ªÔºåÊìÖÈï∑Á≠ñÁï•ÔºåÊéåÊè°ÂÖ®Â±Ä', emoji: 'üê±'},
        water: {pet: 'ÊñØËä¨ÂÖãÊñØË≤ì Sphynx', desc: 'Á•ûÁßòÂÜ∑ÈÖ∑ÔºåÂçªÂ∞çË¶™ËøëÁöÑ‰∫∫Â±ïÁèæÊüîÊÉÖ', emoji: 'üê±'}
      },
      ISTP: {
        fire: {pet: 'Â≠üÂä†ÊãâË≤ì Bengal', desc: 'Á≤æÂäõÊó∫ÁõõÔºåÁÜ±ÊÑõÊåëÊà∞ÔºåÁ∏ΩÂú®Ë°åÂãï‰∏≠ÊàêÈï∑', emoji: 'üê±'},
        earth: {pet: 'Êó•Êú¨Áü≠Â∞æË≤ì Japanese Bobtail', desc: 'ÈùàÊ¥ªÂèàÁ©©ÂÆöÔºåÁÜ±ÊÑõËá™Áî±Âçª‰∏çÂ§±Ë¶èÂæã', emoji: 'üê±'},
        air: {pet: 'ÁæéÂúãÁü≠ÊØõË≤ì American Shorthair', desc: 'ÂèçÊáâÊïèÊç∑ÔºåÊìÖÈï∑Áî®ÂâµÊÑèËß£Ê±∫ÂïèÈ°å', emoji: 'üê±'},
        water: {pet: 'ÊöπÁæÖË≤ì Siamese', desc: 'ÊÑüÊÄß‰∏≠Â∏∂ÂÜíÈö™ÔºåÈ°òÊÑèÈô™‰º¥‰∏¶Êé¢Á¥¢‰∏ñÁïå', emoji: 'üê±'}
      },
      ISFP: {
        fire: {pet: 'Á¥ÖËôéÊñëË≤ì Red Tabby', desc: 'ÁÜ±ÊÉÖËóùË°ìÂÆ∂ÔºåÁ∏ΩËÉΩËÆìÁîüÊ¥ªÂÖÖÊªøËâ≤ÂΩ©', emoji: 'üê±'},
        earth: {pet: 'Êå™Â®ÅÊ£ÆÊûóË≤ì Norwegian Forest Cat', desc: 'ÂÖ∏ÈõÖÂèàÁÜ±ÊÑõËá™ÁÑ∂ÔºåÂÉèÊ£ÆÊûóË©©‰∫∫Ëà¨Ëá™Áî±', emoji: 'üê±'},
        air: {pet: 'ÁæéÂúãÁü≠ÊØõË≤ì American Shorthair', desc: 'Ëá™Áî±ÈùàÈ≠ÇÔºåÊìÅÊúâËÅ∞ÊòéÁöÑÂ∞èËÖ¶Ë¢ã', emoji: 'üê±'},
        water: {pet: 'Â∏ÉÂÅ∂Ë≤ì Ragdoll', desc: 'ÊüîÊÉÖ‰ººÊ∞¥ÔºåÁ∏ΩËÉΩÁµ¶‰∫àÂÆâÂøÉËàáÊ∫´Êöñ', emoji: 'üê±'}
      },
      INFP: {
        fire: {pet: 'ÁæéÂúãÁü≠ÊØõË≤ì American Shorthair', desc: 'Êµ™Êº´ÁêÜÊÉ≥ÂÆ∂ÔºåÂçªÂèàÁÜ±ÊÉÖÔºåÂÉèÁÅ´ÁÑ∞Ëà¨Ê∫´Êöñ', emoji: 'üê±'},
        earth: {pet: 'Â∏ÉÂÅ∂Ë≤ì Ragdoll', desc: 'Á¥îÁúüÊ∫´ÊüîÔºåÁµ¶‰∫∫ÊúÄË∏èÂØ¶ÁöÑÈô™‰º¥', emoji: 'üê±'},
        air: {pet: 'Â∫∑Ê≤ÉÁàæÈõ∑ÂÖãÊñØË≤ì Cornish Rex', desc: 'ËóùË°ìÈùàÈ≠ÇÔºåËÖ¶Ë¢ãË£°ÂÖÖÊªøÂ•áÂ¶ôÈªûÂ≠ê', emoji: 'üê±'},
        water: {pet: 'ÂñúÈ¶¨ÊãâÈõÖË≤ì Himalayan', desc: 'ÊÉÖÊÑüË±êÂØåÔºåÊúÄÊáÇÂøÉÈùàÊ∑±ËôïÁöÑÂ§¢ÊÉ≥ÂÆ∂', emoji: 'üê±'}
      },
      INTP: {
        fire: {pet: 'ÈòøÊØîË•øÂ∞º‰∫ûË≤ì Abyssinian', desc: 'ËÅ∞ÊòéÊ¥ªÊΩëÔºåÁ∏ΩÊúâÊñ∞Â•áÂâµÊÑèÔºåÂÖÖÊªøÂÜíÈö™Á≤æÁ•û', emoji: 'üê±'},
        earth: {pet: 'Ëã±ÂúãÁü≠ÊØõË≤ì British Shorthair', desc: 'ÂÜ∑ÈùúÁêÜÊô∫ÔºåÊòØÂàÜÊûêËàáÁ©©ÂÆö‰∏¶Â≠òÁöÑÂÆåÁæéÂÖ∏ÁØÑ', emoji: 'üê±'},
        air: {pet: 'ÊöπÁæÖË≤ì Siamese', desc: 'ËÅ∞Êòé‰º∂‰øêÔºåËßÄÂØüÂäõË∂ÖÁæ§ÔºåÂÉèÂ∞èÁßëÂ≠∏ÂÆ∂‰∏ÄÊ®£Â•ΩÂ•áÂøÉÁàÜÊ£ö', emoji: 'üê±'},
        water: {pet: '‰øÑÁæÖÊñØËóçË≤ì Russian Blue', desc: 'Ë°®Èù¢ÂÜ∑ÈÖ∑ÔºåÂÖßÂøÉÊüîÊÉÖÔºåÊÑüÊÄßËàáÁêÜÊÄßÂÖºÂÖ∑', emoji: 'üê±'}
      },
      ESTJ: {
        fire: {pet: 'Âæ∑ÂúãÁâßÁæäÁä¨ German Shepherd', desc: 'ËÅ∞Êòé‰∏îÊúçÂæûÔºåÂ§©ÁîüÁöÑÈ†òÂ∞éËÄÖÔºå‰øùË≠∑ÊÖæÂº∑', emoji: 'üêï'},
        earth: {pet: 'ÊãâÂ∏ÉÊãâÂ§ö Labrador Retriever', desc: 'Âø†Ë™†Á©©ÈáçÔºåÊòØÊúÄÂÄºÂæó‰ø°‰ªªÁöÑÂ§•‰º¥', emoji: 'üêï'},
        air: {pet: 'ÊùúË≥ìÁä¨ Doberman Pinscher', desc: 'ÂèçÊáâÊïèÊç∑„ÄÅÊ≤âËëóÂÜ∑ÈùúÔºåÊòØÁ≠ñÁï•ÂûãÂÆàË≠∑ËÄÖ', emoji: 'üêï'},
        water: {pet: 'ÁßãÁî∞Áä¨ Akita Inu', desc: 'ÂÖßÊñÇÂø†ÂøÉÔºå‰øùË≠∑ÊÖæÊ•µÂº∑ÔºåÊòØÊ≤âÁ©©ÁöÑÂÆàË≠∑ËÄÖ', emoji: 'üêï'}
      },
      ESFJ: {
        fire: {pet: 'ÈªÉÈáëÁçµÁä¨ Golden Retriever', desc: 'ÁÜ±ÊÉÖÂèãÂñÑÔºåÂ∏∂Áµ¶‰Ω†ÊªøÊªøÈôΩÂÖâËàáÊ≠£ËÉΩÈáè', emoji: 'üêï'},
        earth: {pet: 'ËÅñ‰ºØÁ¥çÁä¨ Saint Bernard', desc: 'Â∑®Â§ßÂçªÊ∫´ÊüîÔºåÂ§©ÁÑ∂ÁöÑÂÆàË≠∑Â§©‰ΩøÔºåËÆì‰Ω†ÂÆâÂøÉ', emoji: 'üêï'},
        air: {pet: 'ÂèØÂç°Áä¨ Cocker Spaniel', desc: 'ÈñãÊúóÊÑõÁé©ÔºåÂñúÊ≠°‰∫íÂãïÔºåÊòØÂø´Ê®ÇÂ∞èÂπ´Êâã', emoji: 'üêï'},
        water: {pet: 'Âç°Áì¶Âà©ÁéãÊü•ÁêÜÁçµÁä¨ Cavalier King Charles Spaniel', desc: 'ÊÑüÊÉÖË±êÂØåÔºåÊúÄÊÑõÁ™©Âú®‰Ω†Êá∑Ë£°ÔºåÊòØÊ∫´ÊüîÈªè‰∫∫ÁöÑ‰º¥‰æ∂', emoji: 'üêï'}
      },
      ENFJ: {
        fire: {pet: 'ÈÇäÂ¢ÉÁâßÁæäÁä¨ Border Collie', desc: 'ËÅ∞ÊòéÁÜ±ÊÉÖÔºåÊìÖÈï∑Â∏∂È†òÁæ§È´îÔºåÊ¥ªÂäõÊªøÊªø', emoji: 'üêï'},
        earth: {pet: '‰ºØÊÅ©Â±±Áä¨ Bernese Mountain Dog', desc: 'Ê∫´ÊüîÂèØÈù†ÔºåÂ§©ÁÑ∂ÁöÑÂÆàË≠∑ËÄÖÔºåÊúÄÊúâÂÆâÂÖ®ÊÑü', emoji: 'üêï'},
        air: {pet: 'Ëñ©Êë©ËÄ∂ Samoyed', desc: 'ÂæÆÁ¨ëÂ§©‰ΩøÔºåÊ®ÇËßÄÊ¥ªÊΩëÔºåÂÇ≥ÈÅûÂø´Ê®ÇËÉΩÈáè', emoji: 'üêï'},
        water: {pet: 'ÊÑõÁàæËò≠Èõ™ÈÅîÁä¨ Irish Setter', desc: 'ÊÉÖÊÑüÁ¥∞ËÜ©ÔºåÊµ™Êº´Ê∫´ÊüîÔºåÁÜ±ÊÑõÊ∑±Â∫¶ÈÄ£Áµê', emoji: 'üêï'}
      },
      ENTJ: {
        fire: {pet: 'ÁæÖÂ®ÅÁ¥çÁä¨ Rottweiler', desc: 'Âº∑Âã¢È†òÂ∞éÔºå‰øùË≠∑ÊÖæÂº∑ÔºåÊòØÂ§©ÁîüÁöÑÁéãËÄÖ', emoji: 'üêï'},
        earth: {pet: 'Â§ß‰∏πÁä¨ Great Dane', desc: 'È´òË≤¥Á©©ÈáçÔºåÊ∞£Â†¥Âº∑Â§ßÔºåÊòØÈ†òË¢ñÂûãÂÆàË≠∑ËÄÖ', emoji: 'üêï'},
        air: {pet: 'Â®ÅÁë™ÁçµÁä¨ Weimaraner', desc: 'ËÅ∞ÊòéÊïèÊç∑ÔºåÁ≠ñÁï•ÊÄùÁ∂≠ÔºåÊòØÂÆåÁæéÁöÑÂü∑Ë°åËÄÖ', emoji: 'üêï'},
        water: {pet: 'Á¥êËä¨Ëò≠Áä¨ Newfoundland', desc: 'Ê∫´ÂíåÂ∑®‰∫∫ÔºåÊÉÖÊÑüË±êÂØåÔºåÂÖºÂÖ∑ÂäõÈáèËàáÊ∫´Êüî', emoji: 'üêï'}
      },
      ESTP: {
        fire: {pet: 'ÂÇëÂÖãÁæÖÁ¥†„π¥ Jack Russell Terrier', desc: 'Ê¥ªÂäõÂÖÖÊ≤õÔºåÂñúÊ≠°ÂÜíÈö™ÔºåÊòØÊúÄ‰Ω≥ÈÅãÂãïÂ§•‰º¥', emoji: 'üêï'},
        earth: {pet: 'È¨•ÁâõÁä¨ Bulldog', desc: 'Â†ÖÈüåÁ©©ÈáçÔºåËÖ≥Ë∏èÂØ¶Âú∞ÔºåÊòØÂèØÈù†ÁöÑÈô™‰º¥ËÄÖ', emoji: 'üêï'},
        air: {pet: 'ÊØîÊ†ºÁä¨ Beagle', desc: 'Â•ΩÂ•áÂøÉÊó∫ÁõõÔºåÊ©üÊô∫ÈùàÊ¥ªÔºåÁ∏ΩËÉΩÂ∏∂‰æÜÈ©öÂñú', emoji: 'üêï'},
        water: {pet: 'ÊãâÂ∏ÉÊãâÂ§ö Labrador Retriever', desc: 'Ê∫´ÊöñË¶™ÂíåÔºåÊÉÖÊÑüË±êÂØåÔºåÊòØÊúÄ‰Ω≥ÁôÇÁôíÂ§•‰º¥', emoji: 'üêï'}
      },
      ESFP: {
        fire: {pet: 'ÊüØÂü∫Áä¨ Corgi', desc: 'ÈñãÊúóÊ¥ªÊΩëÔºåÁ∏ΩÊòØÂ∏∂‰æÜÊ≠°Ê®ÇÂíåÊ≠£ËÉΩÈáè', emoji: 'üêï'},
        earth: {pet: 'Ê≥ïÂúãÈ¨•ÁâõÁä¨ French Bulldog', desc: 'ÂèØÊÑõÁ©©ÈáçÔºåÊòØÁîüÊ¥ª‰∏≠ÁöÑÂ∞èÁ¢∫Âπ∏', emoji: 'üêï'},
        air: {pet: 'ÂçöÁæéÁä¨ Pomeranian', desc: 'Ê©üÈùàÂèØÊÑõÔºåÂÖÖÊªøÂâµÊÑèÔºåÊòØÁ§æ‰∫§Â∞èÂ§©‰Ωø', emoji: 'üêï'},
        water: {pet: 'Êü•ÁêÜÁéãÁçµÁä¨ Cavalier King Charles Spaniel', desc: 'Ê∫´ÊüîÊÑüÊÄßÔºåÊÉÖÊÑüÁ¥∞ËÜ©ÔºåÊúÄÊáÇ‰Ω†ÁöÑÂøÉ', emoji: 'üêï'}
      },
      ENFP: {
        fire: {pet: 'Êæ≥Ê¥≤ÁâßÁæäÁä¨ Australian Shepherd', desc: 'ÁÜ±ÊÉÖÂâµÊñ∞ÔºåÂÖÖÊªøÊÉ≥ÂÉèÂäõÔºåÊòØÂ§¢ÊÉ≥ÂØ¶Ë∏êËÄÖ', emoji: 'üêï'},
        earth: {pet: 'ÈªÉÈáëÁçµÁä¨ Golden Retriever', desc: 'Ê∫´ÊöñÂèØÈù†ÔºåÁµ¶‰∫∫ÂÆâÂÖ®ÊÑüÔºåÊòØÁêÜÊÉ≥‰∏ªÁæ©ÁöÑÂÆàË≠∑ËÄÖ', emoji: 'üêï'},
        air: {pet: 'ÈÇäÂ¢ÉÁâßÁæäÁä¨ Border Collie', desc: 'ËÅ∞ÊòéÈùàÊ¥ªÔºåÂâµÊÑèÁÑ°ÈôêÔºåÊòØÈªûÂ≠êÁéã', emoji: 'üêï'},
        water: {pet: 'ÊÑõÁàæËò≠Èõ™ÈÅîÁä¨ Irish Setter', desc: 'Êµ™Êº´ÊÑüÊÄßÔºåÊÉÖÊÑüË±êÂØåÔºåÊòØÂøÉÈùàÁõ∏ÈÄöÁöÑÂ§•‰º¥', emoji: 'üêï'}
      },
      ENTP: {
        fire: {pet: 'ÂÇëÂÖãÁæÖÁ¥†„π¥ Jack Russell Terrier', desc: 'Á≤æÂäõÊó∫ÁõõÔºåÂâµÊñ∞ÊÄùÁ∂≠ÔºåÁ∏ΩÊúâÊñ∞ÈªûÂ≠ê', emoji: 'üêï'},
        earth: {pet: 'ÈÇäÂ¢ÉÁâßÁæäÁä¨ Border Collie', desc: 'ËÅ∞ÊòéÁ©©ÈáçÔºåÊìÖÈï∑ÂàÜÊûêÔºåÊòØÁ≠ñÁï•Â§ßÂ∏´', emoji: 'üêï'},
        air: {pet: 'ÊØîÊ†ºÁä¨ Beagle', desc: 'Â•ΩÂ•áÂøÉÂº∑ÔºåÊ©üÊô∫ÂπΩÈªòÔºåÊòØÂ§©ÁîüÁöÑÊé¢Èö™ÂÆ∂', emoji: 'üêï'},
        water: {pet: 'Ëñ©Êë©ËÄ∂ Samoyed', desc: 'Ê∫´ÊöñË¶™ÂíåÔºåÊÉÖÊÑüË±êÂØåÔºåÊìÖÈï∑‰∫∫Èöõ‰∫§ÂæÄ', emoji: 'üêï'}
      }
    };

    function showResult() {
      console.log('showResult ÂáΩÊï∏Ë¢´Ë™øÁî®');
      
      const formData = new FormData(form);
      const mbti = formData.get('q1') + formData.get('q2') + formData.get('q3') + formData.get('q4');
      const element = formData.get('q5');
      
      console.log('MBTI:', mbti, 'Element:', element);
      
      // Â∞áÂÖÉÁ¥†ÂêçÁ®±ËΩâÊèõÁÇ∫‰∏≠Êñá
      const elementMap = {
        'fire': 'ÁÅ´Ë±°',
        'earth': 'ÂúüË±°', 
        'air': 'È¢®Ë±°',
        'water': 'Ê∞¥Ë±°'
      };
      const elementChinese = elementMap[element];
      
      // ÂÑ≤Â≠ò‰ΩøÁî®ËÄÖÁµêÊûú‰æõÁØ©ÈÅ∏‰ΩøÁî®  
      currentUserResult = {
        mbti: mbti,
        element: elementChinese
      };
      
      // Ê™¢Êü• quizMapping ÊòØÂê¶Â≠òÂú®
      if (!quizMapping) {
        console.error('quizMapping Êú™ÂÆöÁæ©');
        return;
      }
      
      if (!quizMapping[mbti]) {
        console.error('Êâæ‰∏çÂà∞ MBTI È°ûÂûã:', mbti);
        return;
      }
      
      if (!quizMapping[mbti][element]) {
        console.error('Êâæ‰∏çÂà∞ÂÖÉÁ¥†:', element, 'Â∞çÊáâÁöÑÁµêÊûú');
        return;
      }
      
      const result = quizMapping[mbti][element];
      console.log('ÁµêÊûú:', result);
      
      const resultDiv = document.getElementById('result');
      if (!resultDiv) {
        console.error('Êâæ‰∏çÂà∞ result div');
        return;
      }
      
      try {
        resultDiv.innerHTML = `
          <div class="ig-result-card">
            <div class="stories-header">
              <div class="stories-profile">
                <div class="stories-avatar">‚ú®</div>
                <div class="stories-info">
                  <div class="stories-username">MBTIÂãïÁâ©Âç†Âçú</div>
                  <div class="stories-time">ÁèæÊôÇÂãïÊÖã</div>
                </div>
              </div>
              <div class="stories-options">‚ãØ</div>
            </div>

            <!-- ÂèØÊªæÂãïÁöÑÂÖßÂÆπÂçÄÂüü -->
            <div class="scrollable-content" style="flex: 1; overflow-y: auto; padding-right: 4px;">
              <div class="decorative-hearts">üíñ‚ú®</div>
              <div class="decorative-sparkles">‚ú®üí´</div>
            
            <div class="result-header">
              <div class="result-emoji-container">
                <div class="emoji-glow"></div>
                <div class="result-emoji">${result.emoji}</div>
              </div>
              <h2 class="result-title">ÊúÄÂÉè‰Ω†ÁöÑÊÄßÊ†ºÂãïÁâ©ÊòØ</h2>
              <h3 class="result-pet-name">${result.pet}</h3>
            </div>
            
            <p class="result-description">${result.desc}</p>
            
            <div style="text-align: center; margin-bottom: 12px;">
              <div class="result-mbti-badge">‚ú® ${mbti} ¬∑ ${elementChinese} ‚ú®</div>
            </div>

            <!-- Áõ∏‰ººÂãïÁâ©ÂçÄÂüü -->
            <div class="similar-animals">
              <div class="similar-title">
                üí´ ÂÄãÊÄßÁõ∏‰ººÁöÑÂ§•‰º¥
              </div>
              <div class="animal-row" id="similar-animals-row">
                <!-- ÂãïÊÖãËºâÂÖ•Áõ∏‰ººÂãïÁâ© -->
              </div>
            </div>

            <!-- ‰∫íË£úÂãïÁâ©ÂçÄÂüü -->
            <div class="similar-animals">
              <div class="similar-title">
                üåü ‰∫íË£úÈÖçÂ∞çÁöÑÊúãÂèã
              </div>
              <div class="animal-row" id="complementary-animals-row">
                <!-- ÂãïÊÖãËºâÂÖ•‰∫íË£úÂãïÁâ© -->
              </div>
            </div>

            <!-- Á§æ‰∫§ÈÄ£ÁµêÊèêÁ§∫ -->
            <div class="social-connection">
              <div class="connection-text">
                ÊâæÂà∞Ë∑ü‰Ω†‰∏ÄÊ®£ÁöÑÊúãÂèã‰∫ÜÂóéÔºüÂø´ÂàÜ‰∫´Áµ¶‰ªñÂÄëÁúãÁúãÔºÅ
              </div>
              <div class="connection-tags">
                <span class="connection-tag">#MBTI</span>
                <span class="connection-tag">#ÂÄãÊÄßÊ∏¨È©ó</span>
                <span class="connection-tag">#ÂãïÁâ©Âç†Âçú</span>
              </div>
            </div>
            
            <div class="share-section">
              <div class="share-title">üì± ÂàÜ‰∫´‰Ω†ÁöÑÁµêÊûúÁµ¶ÊúãÂèãÂêßÔºÅ</div>
              <div class="share-buttons">
                <button class="share-btn instagram" onclick="shareToInstagram()">
                  üì∑ Instagram
                </button>
                <button class="share-btn facebook" onclick="shareToFacebook()">
                  üìò Facebook  
                </button>
                <button class="share-btn twitter" onclick="shareToTwitter()">
                  üê¶ Twitter
                </button>
                <button class="share-btn line" onclick="shareToLine()">
                  üí¨ LINE
                </button>
                <button class="share-btn copy" onclick="copyResult()">
                  üìã Ë§áË£ΩÈÄ£Áµê
                </button>
              </div>
            </div>
            </div>
          </div>
          
          <!-- Êé¢Á¥¢ÊåâÈàïÁç®Á´ãÂú®Â§ñÈù¢ -->
          <div style="text-align: center; margin-top: 20px;">
            <button class="explore-btn" onclick="showExploreMore()">
              üîç Êé¢Á¥¢Êõ¥Â§öÁõ∏‰ººÁöÑÊØõÂ≠©
            </button>
          </div>
        `;
        
        console.log('IG È¢®Ê†º HTML ÂÖßÂÆπÂ∑≤Ë®≠ÁΩÆ');
        
        // Áõ¥Êé•È°ØÁ§∫Ôºå‰∏ç‰ΩøÁî®ÂãïÁï´
        resultDiv.style.display = 'block';
        resultDiv.style.opacity = '1';
        resultDiv.style.transform = 'translateY(0)';
        
        console.log('ÁµêÊûúÂçÄÂüüÂ∑≤È°ØÁ§∫');
        
        // ËºâÂÖ•Áõ∏‰ººÂíå‰∫íË£úÂãïÁâ©
        setTimeout(() => {
          loadSimilarAnimals(mbti, element);
        }, 500);
        
        // Êí≠ÊîæÁµêÊûúÊè≠ÊõâÈü≥Êïà
        setTimeout(() => {
          try {
            playCompletionSound();
          } catch (e) {
            console.log('Èü≥ÊïàÊí≠ÊîæÂ§±Êïó:', e);
          }
        }, 200);
        
        // ÂâµÂª∫ÊÖ∂Á•ùÊïàÊûú
        setTimeout(() => {
          try {
            createFloatingHearts(resultDiv);
          } catch (e) {
            console.log('ÊÑõÂøÉÊïàÊûúÂ§±Êïó:', e);
          }
        }, 500);
        
        // ÊªæÂãïÂà∞ÁµêÊûúÂçÄÂüü
        setTimeout(() => {
          resultDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
          console.log('ÊªæÂãïÂà∞ÁµêÊûúÂçÄÂüü');
        }, 100);
        
      } catch (error) {
        console.error('Ë®≠ÁΩÆÁµêÊûúÂÖßÂÆπÊôÇÁôºÁîüÈåØË™§:', error);
      }
    }
    
    // Á§æÁæ§Â™íÈ´îÂàÜ‰∫´ÂäüËÉΩ
    function shareToInstagram() {
      const text = `üê±üê∂ ÊàëÂÆåÊàê‰∫ÜÊÄßÊ†ºÂãïÁâ©Ê∏¨È©óÔºÅ\n\nÊàëÊúÄÂÉèÁöÑÊòØÔºö${currentUserResult ? getCurrentResultText() : 'Á•ûÁßòÂãïÁâ©'}\n\nMBTI: ${currentUserResult ? currentUserResult.mbti : 'Unknown'} ¬∑ ${currentUserResult ? currentUserResult.element : 'Unknown'}\n\n‰Ω†‰πü‰æÜÊ∏¨Ê∏¨ÁúãÂêßÔºÅ üåü\n\n#MBTI #ÊÄßÊ†ºÊ∏¨È©ó #ÂãïÁâ©ÊÄßÊ†º #ÂøÉÁêÜÊ∏¨È©ó`;
      
      navigator.clipboard.writeText(text).then(() => {
        showNotification('‚ú® ÊñáÂ≠óÂ∑≤Ë§áË£ΩÔºÅÂø´Âéª Instagram ÂàÜ‰∫´ÂêßÔºÅ', 'success');
        playClickSound();
      }).catch(() => {
        showNotification('‚ùå Ë§áË£ΩÂ§±ÊïóÔºåË´ãÊâãÂãïË§áË£Ω', 'error');
      });
    }
    
    function shareToFacebook() {
      const url = encodeURIComponent(window.location.href);
      const text = encodeURIComponent('üê±üê∂ ÊàëÂÆåÊàê‰∫ÜÊÄßÊ†ºÂãïÁâ©Ê∏¨È©óÔºÅÂø´‰æÜÁúãÁúã‰Ω†ÊúÄÂÉèÂì™Á®ÆÊØõÂ≠©ÔºÅ');
      const shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}&quote=${text}`;
      
      window.open(shareUrl, '_blank', 'width=600,height=400');
      playClickSound();
    }
    
    function shareToTwitter() {
      const url = encodeURIComponent(window.location.href);
      const text = encodeURIComponent(`üê±üê∂ ÊàëÂÆåÊàê‰∫ÜÊÄßÊ†ºÂãïÁâ©Ê∏¨È©óÔºÅÊàëÊúÄÂÉèÁöÑÊòØÔºö${currentUserResult ? getCurrentResultText() : 'Á•ûÁßòÂãïÁâ©'} (${currentUserResult ? currentUserResult.mbti : 'Unknown'} ¬∑ ${currentUserResult ? currentUserResult.element : 'Unknown'}) ‰Ω†‰πü‰æÜÊ∏¨Ê∏¨ÁúãÂêßÔºÅ üåü #MBTI #ÊÄßÊ†ºÊ∏¨È©ó`);
      const shareUrl = `https://twitter.com/intent/tweet?text=${text}&url=${url}`;
      
      window.open(shareUrl, '_blank', 'width=600,height=400');
      playClickSound();
    }
    
    function shareToLine() {
      const url = encodeURIComponent(window.location.href);
      const text = encodeURIComponent(`üê±üê∂ ÊàëÂÆåÊàê‰∫ÜÊÄßÊ†ºÂãïÁâ©Ê∏¨È©óÔºÅ\nÊàëÊúÄÂÉèÁöÑÊòØÔºö${currentUserResult ? getCurrentResultText() : 'Á•ûÁßòÂãïÁâ©'}\nMBTI: ${currentUserResult ? currentUserResult.mbti : 'Unknown'} ¬∑ ${currentUserResult ? currentUserResult.element : 'Unknown'}\n‰Ω†‰πü‰æÜÊ∏¨Ê∏¨ÁúãÂêßÔºÅ üåü`);
      const shareUrl = `https://social-plugins.line.me/lineit/share?url=${url}&text=${text}`;
      
      window.open(shareUrl, '_blank', 'width=600,height=400');
      playClickSound();
    }
    
    function copyResult() {
      const url = window.location.href;
      const text = `üê±üê∂ ÊàëÂÆåÊàê‰∫ÜÊÄßÊ†ºÂãïÁâ©Ê∏¨È©óÔºÅ\n\nÊàëÊúÄÂÉèÁöÑÊòØÔºö${currentUserResult ? getCurrentResultText() : 'Á•ûÁßòÂãïÁâ©'}\nMBTI: ${currentUserResult ? currentUserResult.mbti : 'Unknown'} ¬∑ ${currentUserResult ? currentUserResult.element : 'Unknown'}\n\n‰Ω†‰πü‰æÜÊ∏¨Ê∏¨ÁúãÂêßÔºÅ üåü\n\n${url}`;
      
      navigator.clipboard.writeText(text).then(() => {
        showNotification('üìã ÁµêÊûúÈÄ£ÁµêÂ∑≤Ë§áË£ΩÔºÅ', 'success');
        playClickSound();
      }).catch(() => {
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.select();
        try {
          document.execCommand('copy');
          showNotification('üìã ÁµêÊûúÈÄ£ÁµêÂ∑≤Ë§áË£ΩÔºÅ', 'success');
          playClickSound();
        } catch (err) {
          showNotification('‚ùå Ë§áË£ΩÂ§±ÊïóÔºåË´ãÊâãÂãïË§áË£Ω', 'error');
        }
        document.body.removeChild(textArea);
      });
    }
    
    function getCurrentResultText() {
      if (!currentUserResult) return 'Á•ûÁßòÂãïÁâ©';
      
      const elementMap = {
        'ÁÅ´Ë±°': 'fire',
        'ÂúüË±°': 'earth', 
        'È¢®Ë±°': 'air',
        'Ê∞¥Ë±°': 'water'
      };
      
      const elementKey = elementMap[currentUserResult.element];
      if (quizMapping[currentUserResult.mbti] && quizMapping[currentUserResult.mbti][elementKey]) {
        return quizMapping[currentUserResult.mbti][elementKey].pet;
      }
      
      return 'Á•ûÁßòÂãïÁâ©';
    }
    
    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      notification.textContent = message;
      
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${type === 'success' ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' : 'linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%)'};
        color: white;
        padding: 15px 20px;
        border-radius: 12px;
        font-family: 'Inter', 'Noto Sans TC', sans-serif;
        font-size: 0.9rem;
        font-weight: 500;
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        z-index: 10000;
        animation: slideInRight 0.3s ease-out;
        max-width: 300px;
        word-wrap: break-word;
      `;
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.style.animation = 'slideOutRight 0.3s ease-in forwards';
        setTimeout(() => {
          if (notification.parentNode) {
            notification.parentNode.removeChild(notification);
          }
        }, 300);
      }, 3000);
    }
    
    // È°ØÁ§∫Êé¢Á¥¢Êõ¥Â§öÂçÄÂüü
    function showExploreMore() {
      playClickSound();
      
      const exploreDiv = document.getElementById('exploreMore');
      exploreDiv.style.display = 'block';
      
      // ÂàùÂßãÂåñÁØ©ÈÅ∏Âô®
      setupFilters();
      
      // È°ØÁ§∫ÊâÄÊúâÂãïÁâ©ÔºàÊåâÁõ∏‰ººÂ∫¶ÊéíÂ∫èÔºâ
      const filtered = filterAnimals('all', 'all', 'all');
      displayAnimals(filtered, currentUserResult.mbti, currentUserResult.element);
      
      // ÊªæÂãïÂà∞Êé¢Á¥¢ÂçÄÂüü
      setTimeout(() => {
        exploreDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }, 300);
    }

    // ÂàùÂßãÂåñÈü≥È†ª‰∏ä‰∏ãÊñáÔºàÈúÄË¶ÅÁî®Êà∂‰∫§‰∫íÔºâ
    document.addEventListener('click', function initAudio() {
      if (audioContext.state === 'suspended') {
        audioContext.resume();
      }
      document.removeEventListener('click', initAudio);
    }, { once: true });
    
    // È†ÅÈù¢ËºâÂÖ•ÂÆåÊàêÂæåÂàùÂßãÂåñ
    // ËºâÂÖ•Áõ∏‰ººÂíå‰∫íË£úÂãïÁâ©
    function loadSimilarAnimals(currentMbti, currentElement) {
      console.log('ËºâÂÖ•Áõ∏‰ººÂãïÁâ©ÔºåMBTI:', currentMbti, 'ÂÖÉÁ¥†:', currentElement);
      
      if (!animalData || animalData.length === 0) {
        console.log('ÂãïÁâ©Ë≥áÊñôÂ∞öÊú™ËºâÂÖ•ÔºåÁ≠âÂæÖËºâÂÖ•...');
        // Á≠âÂæÖÂãïÁâ©Ë≥áÊñôËºâÂÖ•ÂæåÂÜçÊ¨°ÂòóË©¶
        setTimeout(() => {
          if (animalData && animalData.length > 0) {
            loadSimilarAnimals(currentMbti, currentElement);
          }
        }, 1000);
        return;
      }

      console.log('ÂãïÁâ©Ë≥áÊñôÂ∑≤ËºâÂÖ•ÔºåÂÖ±', animalData.length, 'ÂÄãÂãïÁâ©');

      // ÊâæÂá∫Áõ∏‰ººÂãïÁâ© - ‰ΩøÁî®Á∞°ÂåñÁöÑÈÇèËºØ
      const similarAnimals = animalData.filter(animal => {
        if (!animal.mbti || animal.mbti === currentMbti) return false; // ÊéíÈô§Ëá™Â∑±ÂíåÁÑ°ÊïàË≥áÊñô
        
        // Â∞áÂÖÉÁ¥†Ëã±ÊñáËΩâÊèõÁÇ∫‰∏≠ÊñáÈÄ≤Ë°åÊØîËºÉ
        const elementMap = {
          'fire': 'ÁÅ´Ë±°',
          'earth': 'ÂúüË±°', 
          'air': 'È¢®Ë±°',
          'water': 'Ê∞¥Ë±°'
        };
        const currentElementChinese = elementMap[currentElement];
        
        // Áõ∏Âêå MBTI ÊàñÁõ∏ÂêåÂÖÉÁ¥†ÊàñÁõ∏‰ººÁâπË≥™
        return (
          animal.mbti === currentMbti ||
          animal.zodiac_element === currentElementChinese ||
          (currentMbti && currentMbti.length >= 4 && animal.mbti.length >= 4 && 
           animal.mbti.substring(1, 3) === currentMbti.substring(1, 3))
        );
      }).slice(0, 3);

      // ÊâæÂá∫‰∫íË£úÂãïÁâ©
      const complementaryAnimals = animalData.filter(animal => {
        if (!animal.mbti || animal.mbti === currentMbti) return false; // ÊéíÈô§Ëá™Â∑±ÂíåÁÑ°ÊïàË≥áÊñô
        
        // Â∞áÂÖÉÁ¥†Ëã±ÊñáËΩâÊèõÁÇ∫‰∏≠ÊñáÈÄ≤Ë°åÊØîËºÉ
        const elementMap = {
          'fire': 'ÁÅ´Ë±°',
          'earth': 'ÂúüË±°', 
          'air': 'È¢®Ë±°',
          'water': 'Ê∞¥Ë±°'
        };
        const currentElementChinese = elementMap[currentElement];
        
        // E/I Áõ∏ÂèçÊàñÂÖÉÁ¥†‰∫íË£ú
        if (currentMbti && currentMbti.length >= 1 && animal.mbti.length >= 1) {
          const currentEI = currentMbti[0];
          const animalEI = animal.mbti[0];
          const isOppositeEI = currentEI !== animalEI;
          
          const elementPairs = {
            'ÁÅ´Ë±°': ['È¢®Ë±°', 'ÂúüË±°'],
            'È¢®Ë±°': ['ÁÅ´Ë±°', 'Ê∞¥Ë±°'],
            'ÂúüË±°': ['ÁÅ´Ë±°', 'Ê∞¥Ë±°'],
            'Ê∞¥Ë±°': ['È¢®Ë±°', 'ÂúüË±°']
          };
          const isComplementElement = elementPairs[currentElementChinese]?.includes(animal.zodiac_element);
          
          return isOppositeEI || isComplementElement;
        }
        return false;
      }).slice(0, 3);

      console.log('ÊâæÂà∞Áõ∏‰ººÂãïÁâ©:', similarAnimals.length, 'ÂÄã');
      console.log('ÊâæÂà∞‰∫íË£úÂãïÁâ©:', complementaryAnimals.length, 'ÂÄã');

      // Ê∏≤ÊüìÁõ∏‰ººÂãïÁâ©
      const similarRow = document.getElementById('similar-animals-row');
      if (similarRow) {
        if (similarAnimals.length > 0) {
          similarRow.innerHTML = similarAnimals.map(animal => {
            // Ê†πÊìöÂãïÁâ©Á®ÆÈ°ûÈÅ∏ÊìáË°®ÊÉÖÁ¨¶Ëôü
            let emoji = 'üê±';
            if (animal.species.includes('Áãó') || animal.species.includes('Dog')) {
              emoji = 'üê∂';
            } else if (animal.species.includes('Ë≤ì') || animal.species.includes('Cat')) {
              emoji = 'üê±';
            } else if (animal.species.includes('ÂÖî')) {
              emoji = 'üê∞';
            } else if (animal.species.includes('È≥•')) {
              emoji = 'üê¶';
            }
            
            return `
              <div class="mini-animal">
                <div class="mini-animal-emoji">${emoji}</div>
                <div class="mini-animal-name">${animal.species.split(' ')[0]}</div>
                <div class="mini-animal-type">${animal.mbti}</div>
              </div>
            `;
          }).join('');
          console.log('Áõ∏‰ººÂãïÁâ©Â∑≤Ê∏≤Êüì');
        } else {
          similarRow.innerHTML = '<div style="text-align: center; color: #999; font-size: 0.8rem;">Êö´ÁÑ°Áõ∏‰ººÂãïÁâ©</div>';
        }
      } else {
        console.log('Êâæ‰∏çÂà∞ similar-animals-row ÂÖÉÁ¥†');
      }

      // Ê∏≤Êüì‰∫íË£úÂãïÁâ©
      const complementaryRow = document.getElementById('complementary-animals-row');
      if (complementaryRow) {
        if (complementaryAnimals.length > 0) {
          complementaryRow.innerHTML = complementaryAnimals.map(animal => {
            // Ê†πÊìöÂãïÁâ©Á®ÆÈ°ûÈÅ∏ÊìáË°®ÊÉÖÁ¨¶Ëôü
            let emoji = 'üê±';
            if (animal.species.includes('Áãó') || animal.species.includes('Dog')) {
              emoji = 'üê∂';
            } else if (animal.species.includes('Ë≤ì') || animal.species.includes('Cat')) {
              emoji = 'üê±';
            } else if (animal.species.includes('ÂÖî')) {
              emoji = 'üê∞';
            } else if (animal.species.includes('È≥•')) {
              emoji = 'üê¶';
            }
            
            return `
              <div class="mini-animal">
                <div class="mini-animal-emoji">${emoji}</div>
                <div class="mini-animal-name">${animal.species.split(' ')[0]}</div>
                <div class="mini-animal-type">${animal.zodiac_element}</div>
              </div>
            `;
          }).join('');
          console.log('‰∫íË£úÂãïÁâ©Â∑≤Ê∏≤Êüì');
        } else {
          complementaryRow.innerHTML = '<div style="text-align: center; color: #999; font-size: 0.8rem;">Êö´ÁÑ°‰∫íË£úÂãïÁâ©</div>';
        }
      } else {
        console.log('Êâæ‰∏çÂà∞ complementary-animals-row ÂÖÉÁ¥†');
      }
    }

    document.addEventListener('DOMContentLoaded', function() {
      loadAnimalData();
      
      // Ê∑ªÂä†ÂãïÁï´Ê®£Âºè
      const style = document.createElement('style');
      style.textContent = `
        @keyframes slideInRight {
          from { transform: translateX(100%); opacity: 0; }
          to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideOutRight {
          from { transform: translateX(0); opacity: 1; }
          to { transform: translateX(100%); opacity: 0; }
        }
      `;
      document.head.appendChild(style);
    });
  </script>
</body>
</html>
